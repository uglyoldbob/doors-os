**Doors OS kernel**

This is the repository for the Doors OS kernel. It is written in rust with a tiny amount of assembly where required.

Building has been tested on both windows and linux (ubuntu).

**Building**

*Requirements to build*
* Rust

*Optional to build*
* Cmake

*Optional for testing*
* qemu
* bochs
* virtualbox
* gdb

*Note: For the windows build, virtualbox is used to build the cd image*

**Cmake targets**
* kernel64 - This is the primary target for building the actual kernel itself and the test kernel.
* disassemble - This produces a disassembled version of the kernel at disassemble.txt
* symbols_bochs - This makes some symbols useful for bochs
* image_cd64 - This creates a bootable iso and a bootable test iso for the kernel.
* bochs64 - This builds the kernel, symbol files for bochs, and runs bochs with the cd image.
* bochs64gdb - This is like bochs64 but sets up bochs to use the gdbstub in bochs. This will likely require manually compiling bochs and copying the bochs binary to the same directory where this readme is located.
* virtualbox64 - This creates a virtualbox machine for the kernel, builds the kernel, and runs virtualbox to run the kernel.
* virtualbox64debug - This creates a virtualbox machine for the kernel, builds disassembly output, builds the kernel, and runs virtualbox to run the kernel in debug mode.
* qemucd64 - This builds the kernel and runs qemu to run the kernel.
* gdb64 - This is like qemucd64, but it runs gdb attached to qemu for debugging.

**Kernel varieties**
There are two kernel varieties currently. There is the plain kernel and a test version of the kernel. The test version of the kernel runs all of the test functions defined in the kernel to verify correct behavior of the kernel.

**Kernel config**
There is a kernel config file that is required to build the kernel, located at ./kernel/config.toml (assuming you are at the root of this repository). It will also be useful to look at ./.config/config.toml to check the value of [build].target.

Eventually there will be gui based and command line based programs to generate and modify this configuration. For now it must be generated by hand. Here is an example configuration that can be used to get started.
```
machine_name = "pc64"
acpi = false
gdbstub = true
```